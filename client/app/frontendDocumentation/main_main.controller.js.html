<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: main/main.controller.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: main/main.controller.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

(function() {

    class MainController {
       /**
        * @description Constructor of the Maincontroller
        * @constructor
        * @param {Upload} Upload - Service to upload
        * @param {Offer} Offer - Service to get offerings
        * @param {$geolocation} $geolocation - The service to get location
        * @param {$state} $state - State service.
        */
        constructor(Offer, Auth, $geolocation, $state) {
            this.position;
            this.$geolocation = $geolocation;
            this.$state=$state;
            this.Offer = Offer;
            this.offers = [];
            this.options = {};
            this.userMap;
            this.marker;
            this.isLoggedIn = Auth.isLoggedIn;
            this.position;
            this.showSpinner = true;
            this.showInfo = false;
        }
        /**
         *@description initialisation method
         */
        $onInit() {
            this.$geolocation.getCurrentPosition({
                timeout: 6000
                    
            }).then(position => {
                this.showSpinner = false;
                this.position = position;
                this.options.zoom = 13;
                this.options.center = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
                this.options.mapTypeId= google.maps.MapTypeId.ROADMAP;
                this.userMap = new google.maps.Map(map,this.options);
                this.offers = this.Offer.query({longitude:position.coords.longitude,latitude:position.coords.latitude});

            })
            .catch(() => {
                this.showSpinner = false;
                this.showInfo = true;
            });

        }
        /**
         * @description Method to redirect a file to the createOffering controller
         * @param {file} file -a file in this case a picture.
         */
        uploadPicture(file){
            if(file &amp;&amp; this.isLoggedIn()){
                this.$state.go("createOffering",{obj: file});
            }
        
        }
        /**
         * @description Method to set a google marker for the Offer
         * @param {offer} Offer object to set the marker.
         */
        setMarker(offer){
				var marker = new google.maps.Marker({
					map: this.userMap,
					animation: google.maps.Animation.DROP,
					position: new google.maps.LatLng(offer.loc[1],offer.loc[0]),
                    visible: true,
                    icon: '/assets/icons/icon.png'
				});
        }
        
    }

    angular.module('geomarketApp')
        .component('main', {
            templateUrl: 'app/main/main.html',
            controller: MainController
        });

})();
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AdminController.html">AdminController</a></li><li><a href="CreateOfferingComponent.html">CreateOfferingComponent</a></li><li><a href="DetailOfferComponent.html">DetailOfferComponent</a></li><li><a href="EditOfferComponent.html">EditOfferComponent</a></li><li><a href="LoginController.html">LoginController</a></li><li><a href="MainController.html">MainController</a></li><li><a href="MyOffersComponent.html">MyOffersComponent</a></li><li><a href="SettingsController.html">SettingsController</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addComment">addComment</a></li><li><a href="global.html#my">my</a></li><li><a href="global.html#query">query</a></li><li><a href="global.html#update">update</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Mon May 16 2016 18:01:07 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
